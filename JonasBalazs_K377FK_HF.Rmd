---
title: |-
  Többváltozós statisztikai modellek
  házi feladat
author: "Balázs Jónás"
date: "`r Sys.Date()`"
output:
  pdf_document: default
  html_document: default
---


```{r cache, include=FALSE}
cache.enabled <- FALSE
```
```{r dependencies, message=TRUE, warning=FALSE, include=FALSE, cache=cache.enabled}
install.packages('pacman')
library(pacman)
pacman::p_load(ggplot2,
               magrittr, # pipe
               tidyr, # replace_na
               dplyr, # select
               psych, # describe, winsor.mean, winsor.sd
               rcompanion, #groupwiseMean, cramerV
               MASS, # stepAIC
               mRMRe, # mRMR.data
               glmnet, # ridge
               readxl # read_excel
               )
```

# Probléma felvetése


Célom a magyar államkötvények első forgalomba hozatalának vizsgálata.

Az első részben bemutatom az adat forrását és ismérveit, valamint az adattisztítás lépéseit. A második részben az 5 éves lejárat aukcióinak forgalmi adatait és hozamait fogom vizsgálni. A harmadik részben a kettő kapcsolatával foglalkozom.
A negyedik részben beszerezhető adatokból igyekszem kiválasztani azokat, amik legjobban tudják előrejelezni az aukció eredményét.

Meg kell jegyezni, hogy az ismérvek időfüggését figyelmen kívül hagytam és idő helyett nagyobb időszakokat, mint kategóriákat használtam. Mivel a táblázat az összes aukció adatát tartalmazza, nem történt mintavételezés.



# 1. Adatok forrása és feldolgozása


Forrás: https://akk.hu/statistics/historical-data

Elérés: 2022. nov 21

A táblázat a magyar államkötvények aukciók tartalmazza 1987-től 2021 végéig.


## Adatok jellemzése

### Kötvények alapadatai

|Oszlop neve|Tipusa|Jelentése|
| :---: | :----: |  :---: |
|Type|Nominális|Tranzakció típusa: *ISSUE* (elsődleges kibocsátás), *BUYBACK*(visszavásárlási aukció), *SUBSCRIPTION* (jegyzés), *NON_COMPETETITIVE* (aukciót követő jegyzési mód), *TAP_ISSUE* (rábocsátás), *SWITCH* (csereaukció) |
|Tenor|Ordinális|A kötvény futamidejét jelöli években, hónapokban vagy hetekben. Fontos megjegyezni, hogy ebben az esetben a különbség nem értelmezhető, ezért nem tekinthető intervallum típusnak|
|Security Type|Nominális|A kötvény típusát jelöli|
|Alias|Nominális|A kötvény rövid neve.|
|Date|Intervallum|Az aukció dátuma. A dolgozatban nem vettem figyelembe az ismérvek időbeli alakulását, csak néhány helyen a jelenség megértésénél használtam fel.|
|Settlement|Intervallum|Az elszámolás napja.|
|Maturity Date|Intervallum|A kötvény lejáratának napja.|
|Interest Type|Nominális|Diszkont, fix vagy változó kamatozású kötvény|


### A Kötvények keresletére, hozamára és árára vonatkozó adatok

|Oszlop neve|Tipusa|Jelentése|
| :---: | :----: |  :---: |
|Announced (mln)|Arányskála|Meghirdetett mennyiség névértéke millió forintban|
|Bid Amount (mln)|Arányskála|Benyújtott mennyiség névértéke millió forintban|
|Accepted (mln)|Arányskála|Elfogadott mennyiség névértéke millió forintban|
|Min Yield (%)|Arányskála|Az elfogadott ajánlatok közül a legalacsonyabb hozamú ajánlat|
|Max Yield (%)|Arányskála|Az elfogadott ajánlatok közül a legmagasabb hozamú ajánlat|
|Avg Yield (%)|Arányskála|Az elfogadott ajánlatok mennyiséggel súlyozott átlaga|
|Min Price (%)|Arányskála|Az elfogadott ajánlatok közül a legalacsonyabb árfolyamú a névérték százalékában|
|Max Price (%)|Arányskála|Az elfogadott ajánlatok közül a legmagasabb árfolyamú a névérték százalékában|
|Avg Price (%)|Arányskála|Az elfogadott ajánlatok közül árfolyamainak mennyiséggel súlyozott átlaga a névérték százalékában|

### Számított oszlopok

Hasznosnak tartottam kiemelni a dátumból az évet. Ezt a dataframeben "Year"-nek neveztem, intervallum típusú ismérv.


Az idő helyett 10 éves időszakokat vizsgáltam. Jelenleg diszjunkt időszakok, amelyeken a rendezés értelmezett, ezért tekinthető ordinális típusnak.


Szintén számított oszlop a legkisebb és legnagyobb hozamú ajánlat különbsége, amit YieldSpreadnek neveztem el.


## Megjegyzések

A dolgozatban csak az elsődleges kibocsátások (ISSUE) ismérveit fogom vizsgálni.

A Tenor változóban kötvény tipusától függően különböző jelölést használtak az 1 éves referencia papír esetén: diszkont kincstárjegy esetén "12M", államkötvény esetén az "1Y" jelölést használták. Az adattisztítás során egységes "1Y"-ra cseréltem.
<!-- Példa: -->
<!-- Type	Tenor	Security Type	Alias	Date	Settlement	Interest Type	Announced (mln)	Maturity Date -->
<!-- ISSUE	10Y	KTV	2013/D	2003.05.15	2003.05.22	Fix	30,000.00	2013.02.12 -->
<!-- ISSUE	3Y	KTV	2013/D	2009.05.07	2009.05.13	Fix	5,000.00	2013.02.12 -->

### Egy kötvény életciklusa

| Tenor | Alias | Date | Maturity Date | Hátralévő futamidő |
| :---: | :---: | :---: | :---: | :---: |
| 10Y | 2013/D | 2002.01.10 | 2013.02.12 | 11 év 1 hónap | 
| 3Y | 2013/D | 2009.05.07 | 2013.02.12| 3 év 9 hónap |
| 1Y | 2013/D | 2012.04.18 | 2013.02.12 | 10 hónap |
| 6M | 2013/D | 2012.05.16 | 2013.02.12 | 9 hónap |
| 6M | 2013/D | 2012.09.05 | 2013.02.12 | 5 hónap |
| 3M | 2013/D | 2012.09.19 | 2013.02.12 | 5 hónap |
| 3M | 2013/D | 2012.10.31 | 2013.02.12 | 3 hónap |


Hozamok és árfolyamok csak akkor értelmezhetőek, ha az elfogadott mennyiség pozitív, azaz sikeres volt az aukció. A sikertelen aukciókat a hozamok vizsgálatakor kiszűrtem.

<!-- Fel nem használt ismérvek -->
A "Pro-rata (%)", "Bid pcs", "Accepted pcs" ismérvek pontos definícióját nem találtam meg. Bár az "ISIN" számít az értékpapír azonosítójának, nem lesz szükség rá. A további oszlop a csereaukciók során felajánlott értékpapírok adatait tartalmazza.


## Szűrések

Csak az elsődleges kibocsátásokat veszem figyelembe.

Nem veszem figyelembe a lakossági állampapírokat, mivel ezek értékesítése nem piaci alapot történik, nem tükrözi a magyar állammal szembeni piaci elvárásokat.

A devizakötvényeket nem érdemes összevetni a forint kötvényekkel a devizaárfolyam valamit az adott devizához tartozó referencia papírnak tekintett állampapírok (pl dollár esetén USA, euró esetén a német állam által kibocsátott kötvények) ismerete nélkül.

Csereaukciók: nem jut új forráshoz az állam, mind a vevő, mind az eladó részéről elsősorban kockázatkezelési célokat szolgál.

Visszavásárlások: Ebben az esetben az állam vevő szerepében jelenik meg, gyakran a lejáratok előtt több részletben vásárolnak vissza kötvényeket

```{r loading.excel, warning=FALSE, include=FALSE, cache=cache.enabled}
## Adatok betöltése és tisztítása ====
auctions <- read_excel("AUCTION_2021_221121191038.xlsx")
auctions <- as.data.frame(auctions)
year <- as.numeric(format(auctions$Date, format="%Y"))

# 10 éves időszakok generálása
periodLength <- 10
periodStarts <- seq(1990, 2030, periodLength)
period <- .bincode(year, periodStarts, right=F)
auctions$Period  <- as.factor(paste(
  periodStarts[period],
  "-", 
  periodStarts[period]+periodLength-1))

# 1 éves lejáratra kétféle jelölést használtak
auctions$Tenor[auctions$Tenor=="12M"]<-"1Y"

# https://akk.hu/statisztika/hozamok-indexek-forgalmi-adatok/referenciahozamok
referenceBonds <- c("3M", "6M",
                    "1Y", "3Y","5Y",
                    "10Y", "15Y", "20Y",
                    "other")
# manuális rendezés:
auctions$Tenor<- factor(auctions$Tenor,
                        levels=referenceBonds)
auctions$Tenor <- auctions$Tenor %>% replace_na(replace = "other")

# Szűrés új kibocsátásokra és fix kamatozási kötvényekre
issues<-auctions[auctions$Type=="ISSUE"
                 & auctions$`Interest Type`!="Float",]
```

```{r bond5.filter, include=FALSE, cache=cache.enabled}
issues$YieldSpread <- issues$`Max Yield (%)` - issues$`Min Yield (%)`
bond5 <- issues[issues$Tenor == "5Y",
                c("Date",
                  "Avg Yield (%)", "Accepted (mln)", # elsődlegesen vizsgált mennyiségek
                  "Announced (mln)", "Bid Amount (mln)",
                  "Min Yield (%)", "Max Yield (%)",
                  "Avg Price (%)", "Min Price (%)","Max Price (%)",
                  "YieldSpread",
                  "Period")]

# Oszlopok nevét egyszerűsítem
colnames(bond5) <- c("Date",
                     "Yield", "Accepted",
                     "Announced", "BidAmount",
                     "MinYield", "MaxYield",
                     "AvgPrice", "MinPrice", "MaxPrice",
                     "YieldSpread", "Period")

# Olvashatóság miatt az elfogadott és meghirdetett mennyiséget millárd forintban használom
bond5$Accepted <- bond5$Accepted/1000
bond5$Announced <- bond5$Announced/1000
bond5$BidAmount <- bond5$BidAmount/1000


# Sikeres kibocsátások:
bond5 <- bond5[bond5$Accepted>0, ]

bond5numeric <- dplyr::select(bond5,-Period, -Date ) # hidden by MASS::select
```

## Bepillantás végeredményként kapott adathalmazba:


```{r glimpse}
head(bond5)
```

# 2. Az 5 éves kötvények forgalmi adatainak leíró statisztikája


A következőkben a két vizsgált mennyiséget az elfogadott mennyiség és hozamot mutatom be, majd az aukción elért hozamot vizsgálom alaposabban.

Az Államadósságkezelőnek korlátozottan, de van mozgástere az aukciók során. Aukció előtt a finanszírozási igény alapján meghatározzák a meghirdetett mennyiséget és a futamidőt. Az aukció elfogadásakor az mennyiséggel tudja kontrollálni az átlagos hozamot vagy eredménytelennek nyilváníthatja az aukciót. (Két alkalommal fordult elő, hogy a meghirdetett mennyiség kétszeresét fogadta el). Feltehetően az ÁKK már jól ismeri az elsődleges forgalmazókat és ezt is figyelembe tudják venni a meghirdetett mennyiség meghatározásakor.

```{r accPerAnnounce, eval=FALSE, include=FALSE}
issues[((issues$`Accepted (mln)`/issues$`Announced (mln)`)>1.5),]
```


## Hozamok

A hozamok eloszlása bimodális, ami a hisztogramon látszik a legjobban. A hozamban nem jellemzőek a nagy ugrások és outlierekkel sem találkozunk. A describe() függény eredményénél a trimmed érték default értéke 0.1, vagyis a fölső és alső 5%-ot hagyja el az átlagból.

```{r yields}
descYield <- describe(bond5$Yield, quant=c(0.25, 0.5, 0.75))
print(t(descYield), digits = 2)

ggplot(data=bond5, aes(x=Yield)) +
  geom_histogram(aes(y=..density..)) +
  geom_density(bw=0.3) +
  labs(title="Average yield of 5-year bonds at issue", # UTF-8 feliratot nem sikerült megoldani
       x="Average yield (%)",
       y= "Relative frequency")

ggplot(data=bond5, aes(x=Yield)) +
  geom_boxplot() +
  coord_flip() +
  labs(title = "Average yield of 5-year bonds at issue",
       x = "Average yield (%)"
       )
  
# 
# ggplot(data=bond5, aes(x=Yield)) +
#   geom_density(bw=0.1) +
#   labs(title="Kernel density becslő (bw=0.1)",
#        x="Átlaghozam (%)",
#        y= "Relatív gyakoriság")
```


## Elfogadott mennyiségek

Mivel csak a sikeres aukciókat vizsgálom, ezért a minimum nem nulla lesz, viszont találunk néhány kiugróan magas értéket. Később látni fogjuk, hogy ezek valóban nem normál piaci körülmények között alakultak ki. A dátumokból látszik, hogy a nagyobb kibocsátások 2007-2008-as és 2020-as nehezebb időkben történek. 

Emiatt érdemes valamilyen korrekciót alkalmazni az átlag számításnál. Az outlierek is értékes információval bírnak, ezért trimmelés helyett winsorizált átlagot és szórást fogom kiszámolni. 

Az eloszlás kissé jobbra elnyúló, normálishoz képest csúcsosabb, nem normális eloszlású.

```{r hist}
descAmount <- describe(bond5$Accepted, quant=c(0.25, 0.5, 0.75))
print(t(descAmount))

print(paste('winsorizált átlag:', round(winsor.mean(bond5$Accepted, trim = 0.1),2)))
print(paste('winsorizált szórás:', round(winsor.sd(bond5$Accepted, trim = 0.1),2)))

ggplot(data=bond5, aes(x=Accepted)) +
  geom_histogram(bins=16)+
  labs(title="Accepted amounts of 5Y bonds",
       x="Accepted amount (bn. HUF)",
       y= "Frequency")


ggplot(data=bond5, aes(x=Accepted)) +
  geom_boxplot() +
  coord_flip() +
  labs(
       x="Accepted amount (bn. HUF)",
       y= "")

print(paste("Outlierek száma: ",
  sum(bond5$Accepted>mean(bond5$Accepted) + 1.5*IQR(bond5$Accepted))))

print("A kiugró értékek dátumai:")
bond5[bond5$Accepted>mean(bond5$Accepted) + 1.5*IQR(bond5$Accepted), "Date"]
```




# 3. Hozam és mennyiség viszonya az 5 éves kötvények esetén

 
Az Államadósság kezelő által befolyásolható mennyiség hozam és az elfogadott mennyiség. A két mennyiség között gyenge negatív korreláció van. A p-érték 0.0002 1%-nál is kisebb, ezért elvetjük, hogy az egyenes meredeksége 0, így a kapcsolat szignifikáns.

Ennek egy lehetséges magyarázata, hogy több benyújtott ajánlat azt jelzi, hogy a befektetők kevésbé tartják kockázatosnak a magyar kötvényeket amivel együtt kisebb kockázati felárat várnak. 


```{r }
cor.test(bond5numeric$Yield, bond5numeric$Accepted)
```

```{r y.vs.acc}
ggplot(bond5, aes(Yield, Accepted)) +
  geom_point() +
  geom_density2d() +
  geom_density2d_filled(alpha=0.5) 
```

## Klaszterelemzés

A pontok 3 csoportba tömörülnek. Ezt a három csoportot kmeans módszerrel próbálom szétválasztani, majd összevetem egy eddig nem használt változóval, az időszakkal.

A 2000 évekre a magas hozamok voltak jellemzőek, a 2010-es években megjeltek az alacsonyabb hozamok. A 2020-as éveknek csak az elején vagyunk, ezért nem hasonlítanám a másik kettőhöz. A legalsó grafikonon látszik, hogy a 2008-9-es válság után láthatóan megváltozott az ÁKK stratégiája. Nagyobb kibocsátások helyett a jobban kontrollálható és kisebb kockázatot jelentő módon gyakrabban, de kisebb összegeket hirdet meg.

```{r kmeans}
k <- kmeans(scale(bond5numeric[,c("Yield", "Accepted")]), centers=3)
kmeans_plot <- bond5numeric
kmeans_plot$cluster <- as.factor(k$cluster)

ggplot(kmeans_plot, aes(x=Yield, y=Accepted)) +
  geom_point(aes(colour=factor(cluster)))


ggplot(bond5, aes(x=Date, y=Accepted)) +
  geom_point() +
  labs(title = "Issued ammounts during time")

head(kmeans_plot)



```

```{r cramer1, include=FALSE}
kmeans_plot$Period <- bond5$Period
bond5.cramer <- cramerV(kmeans_plot$Period, kmeans_plot$cluster)
```
Felmerült bennem az a lehetőség, hogy a k-means algoritmus által "megtalált" csoportok időszakonként megváltoztak. A két kategórikus változó vizsgálatára a Cramer-V együttható ad megoldást. Az értéke `r bond5.cramer`, ami közepesen erős kapcsolatra utal. További kérdés, hogy a "sokaságban", vagyis a későbbi aukciók során is megmarad-e ez a kapcsolat. Erre $\chi^2$-teszt ad választ, melynek null-hipotézise, hogy a Cramer-együttható 0. A p-érték bármely küszöbnél kisebb, ezért a kapcsolat szignifikáns is.

```{r}


ggplot(data = kmeans_plot, aes(x=Period)) +
  geom_bar(aes(fill=cluster), position = 'fill') +
  scale_fill_brewer(palette="Dark2")
cramerV(kmeans_plot$Period, kmeans_plot$cluster)
chisq.test(table(kmeans_plot[,c("Period", "cluster")]))
```

# 4. A hozamot meghatározó tényezők


## Korreláció

Három csoport vehető észre, amik a csoporton belül erős korrelációt mutatnak: hozamok, árfolyamok és mennyiségek.

Ismert, hogy a hozam és árfolyam között determinisztikus kapcsolat van. A véletlen "zaj" abból adódik, hogy a konkrét értékpapír kíválasztása és annak cash-flowja előre nem ismert. A hozamok és árfolyamok között ezért jelentős negatív korreláció van. Amit érdemes megjegyezni, hogy a hozam és a spread közötti pozitív korrelációt.

Nem meglepő a meghirdetett és elfogadott mennyiségek közötti erős korreláció.

Érdemes még felfigyelni az elfogadott mennyiség és hozam közötti gyenge negatív korrelációra. Az aukció során az ÁKK a legkisebb hozamútól kezdve sorban fogadja el az egyre nagyobb hozamú (kisebb árfolyamú) ajánlatokat a stratégiája által meghatározott mértékig. Általában a meghirdetett mennyiségig, kedvező napon, akár annak kétszeresét is elfgoadhatja.



```{r corr, cache=cache.enabled}
print(cor(bond5numeric), digits = 1)
corPlot(bond5numeric, FALSE)


```

## Kollinearitás ellenőrzése

A korrelációk alapján nem meglepő az sem, hogy van multikollinearitás a prediktor változók között. Ennek egyik előzetes jele, hogy a regresszorok mátrixa nem teljes rangú. A másik pedig, hogy a kondiciószáma nagy, emiatt a megoldás relatív hibája használhatatlanul nagy.
```{r condi}
X <- as.matrix(dplyr::select(bond5numeric,-Yield))

qr(t(X)%*%X)$rank == min(dim(t(X)%*%X))

lambda <- eigen(t(X) %*% X)$values
print(paste('Condition number:', max(lambda) / min(lambda)))
# meg sem próbálom invertálni

```

## Változószelekció

Tudjuk, hogy változók között erős korrelációk vannak, ezért a mRMR és forward módszerrel próbálom kiválasztani a szükségeseket.

### Forward módszer 1. próbálkozás

Az első próbálkozás forward módszernek indult, de nem tagadom trial and error lett belőle, csak történeti okból hagyom benne. A $R^2$ együttható 1, ami nem meglepő, ha azok a változók kerültek a regresszorok közé, mivel a független változó korrelációja 1.

```{r select.fwd.1}
lm.min <- lm(Yield ~ 1, data=bond5numeric)
print(lm.min)

lm.fwd.1 <- stepAIC(lm.min,
                  direction = "forward",
                  trace = TRUE,
                  scope=list(lower=lm.min,
                             upper=~ Accepted + Announced + BidAmount +
                               AvgPrice +MinPrice+MaxPrice +
                               MinYield + MaxYield +
                               YieldSpread))
summary(lm.fwd.1)
names(lm.fwd.1$coefficients)

```

<!-- A továbbiakban csak azokat hagyom -->
```{r select.fwd.lmt}

bond5limited <- dplyr::select(bond5numeric, -MinYield, -MaxYield,
                             -MinPrice, -AvgPrice, -MaxPrice)
colnames(bond5limited)
lm.min <- lm(Yield ~ 1, data=bond5limited)
print(lm.min)

lm.fwd.limited <- stepAIC(lm.min,
                          direction = "forward",
                          trace = TRUE,
                          scope=list(lower=lm.min,
                                     upper=~ Accepted + Announced + BidAmount +
                                       # AvgPrice +MinPrice+MaxPrice +
                                       # MinYield + MaxYield +
                                       YieldSpread))
summary(lm.fwd.limited)


```



```{R select.mrmr, eval=FALSE, include=FALSE}
# Az mRMR módszer ugyanazt az eredményt adná
bond5mrmr <- mRMR.data(bond5limited)
x<-solutions(mRMR.classic(data = bond5mrmr,
                          target_indices = c(1),
                          feature_count = 5))
colnames(bond5limited)[x[[1]]]

lm.mrmr <- lm(Yield ~ YieldSpread + Accepted + BidAmount + Announced,
              data=bond5limited)
summary(lm.mrmr)

```

Az AIC értékeken az látszik, hogy amint elhagyom a determinisztikus (árfolyamok) és erősen korreláló tagokat az illeszkedés kevésbé pontos.

```{R selection.comp}
AIC(lm.fwd.1)
AIC(lm.fwd.limited)
```

## Ridge

A következő példában nem zárunk ki változót. A ridge regresszió feltételezi, hogy a változók sztenderdizáltak, de a glmnet alapbeállítás szerint ezt elvégzi.
```{R ridge}

X <- as.matrix(dplyr::select(bond5numeric,-Yield))
Y <- as.matrix(dplyr::select(bond5numeric, Yield))

ridge.fit <- cv.glmnet(X, Y, type.measure = "mse", alpha=0, family='gaussian')
plot(ridge.fit)
```

## Lineáris regresszió és ridge eredményeinek összehasonlítása

Ahhoz, hogy az AIC érték összehasonlítható legyen, azokat a konstansokat, amik minden modellben azonosak, elhagytam:
$$
AIC = 2 k + nrow(data) * ln(RSS)
$$


```{R aic}
rse <- function(residuals, n.params) {
  # source: https://www.statology.org/residual-standard-error-r/
  k <- n.params - 1
  SSE <- sum(residuals^2)
  n <- length(residuals)
  result <- sqrt(SSE / (n-k-1))
  result
}
aic <- function(residuals, n.params) {
  # https://en.wikipedia.org/wiki/Akaike_information_criterion
  result <- 2 * n.params + length(residuals) * log(rse(residuals, n.params))
  result
}
r.squared <- function(residuals, expected, n.params) {
  RSS <- sum(residuals^2)
  TSS <- sum((expected - mean(expected))^2)
  R2 <- 1 - RSS / TSS
  df.res <- length(residuals) - n.params
  df.tot <- length(residuals) - 1
  result <- 1 - RSS/df.res / (TSS/df.tot)
  result
}

print(ridge.fit$lambda.min)
ridge.predicted <- predict(ridge.fit, s=ridge.fit$lambda.min, X)
ridge.residuals <- Y - ridge.predicted
```

A forward módszerhez képest mind az átlagos négyzetes hiba, mind az AIC alapján jobban teljesít a ridge módszer. Meg kell jegyezni, hogy a $R^2$ még továbbra is nagyon magas. A *glmnet* cross validation függvénye az átlagos négyzetes hibát minimalizálta, amit viszonylag alacsony $\lambda$-val ért el, vagyis kicsit tért csak el lineáris regresszióhoz képest.

\begin{center}
\begin{tabular}{||c c c c||}
\hline
Módszer & RSE & AIC & adj. $R^2$\\
\hline\hline
Forward (összes változóval indítva) &
`r rse(lm.fwd.1$residuals, length(lm.fwd.1$coefficients))` &
`r aic(lm.fwd.1$residuals, length(lm.fwd.1$coefficients))` &
`r r.squared(lm.fwd.1$residuals, Y, length(lm.fwd.1$coefficients)) # az elvárt érték minden esetben ugyanaz`\\
\hline
Forward (limitált változókkal) &
`r rse(lm.fwd.limited$residuals, length(lm.fwd.limited$coefficients))` &
`r aic(lm.fwd.limited$residuals, length(lm.fwd.limited$coefficients))` &
`r r.squared(lm.fwd.limited$residuals, Y, length(lm.fwd.limited$coefficients))`\\
\hline
Ridge &
`r rse(ridge.residuals, ncol(X)+1) # +1 a lambdának` &
`r aic(ridge.residuals, ncol(X)+1) # +1 a lambdának` &
`r r.squared(ridge.residuals, Y, ncol(X)+1)`\\
\hline
\hline


\end{tabular}
\end{center}

